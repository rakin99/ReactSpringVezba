{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dejan\\\\Documents\\\\resources\\\\src\\\\Users.jsx\";\nimport React from \"react\";\nimport PrikazKorisnika from \"./PrikazSvihKorisnika\";\nimport FilterUsers from \"./FilterUsers\";\nimport Korisnik from \"./Korisnik\";\nimport $ from \"jquery\";\n\nclass Users extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      users: [],\n      user: \"\",\n      admin: false\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.filter = this.filter.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.deleteUser = this.deleteUser.bind(this);\n  }\n\n  componentDidMount() {\n    const config = {\n      headers: new Headers({\n        'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n      }, {\n        'Access-Control-Allow-Methods': 'GET'\n      })\n    };\n    fetch('http://localhost:8080/bioskop/users', config).then(res => res.json()).then(res => {\n      this.setState({\n        users: res\n      });\n    });\n  }\n\n  handleChange(event) {\n    const checked = event.target.checked;\n\n    if (checked === true) {\n      this.setState(prevState => {\n        const updateUsers = prevState.users.map(u => {\n          if (u.korisnickoIme === prevState.user.korisnickoIme) {\n            u.authorities = \"ROLE_REGULAR ROLE_ADMIN\";\n            var config = {\n              dataType: 'json',\n              method: 'put',\n              headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n              },\n              body: JSON.stringify(u)\n            }; // On submit of the form, send a POST request with the data to the server.\n\n            fetch('http://localhost:8080/bioskop/users', config).then(res => res.json()).then(res => console.log(res));\n          }\n\n          return u;\n        });\n        return {\n          users: updateUsers,\n          admin: true\n        };\n      });\n    } else {\n      this.setState(prevState => {\n        const updateUsers = prevState.users.map(u => {\n          if (u.korisnickoIme === prevState.user.korisnickoIme) {\n            u.authorities = \"ROLE_REGULAR \";\n            var config = {\n              dataType: 'json',\n              method: 'put',\n              headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n              },\n              body: JSON.stringify(u)\n            }; // On submit of the form, send a POST request with the data to the server.\n\n            fetch('http://localhost:8080/bioskop/users', config).then(res => res.json()).then(res => console.log(res));\n          }\n\n          return u;\n        });\n        return {\n          users: updateUsers,\n          admin: false\n        };\n      });\n    }\n  }\n\n  filter() {\n    const username = $('#idUsername').val() === \"\" ? \"null\" : $('#idUsername').val();\n    const role = $('#idRole').val() === \"\" ? \"null\" : $('#idRole').val();\n    const sort = $('#idSort').val() === \"\" ? \"null\" : $('#idSort').val();\n    fetch('http://localhost:8080/bioskop/users/' + username + \"/\" + role + \"/\" + sort).then(res => res.json()).then(res => {\n      this.setState({\n        users: res\n      });\n    });\n  }\n\n  handleClick(event) {\n    const name = event.target.name;\n    this.state.users.map(u => {\n      if (u.korisnickoIme === name) {\n        const a = u.authorities.includes(\"ROLE_ADMIN\") ? true : false;\n        this.setState({\n          user: u,\n          admin: a\n        });\n      }\n    });\n    $('#tableUsers').hide();\n  }\n\n  deleteUser(event) {\n    const name = event.target.name;\n    var config = {\n      method: 'delete',\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n      }\n    }; // On submit of the form, send a POST request with the data to the server.\n\n    fetch('http://localhost:8080/bioskop/users/' + name, config);\n    this.setState({\n      user: \"\"\n    });\n    this.setState(prevState => {\n      const updateUsers = prevState.users.filter(u => u.korisnickoIme !== name);\n      return {\n        users: updateUsers\n      };\n    });\n    $('#tableUsers').show();\n    $('#Bioskop').children('#idKorisnik').remove();\n  }\n\n  render() {\n    const prikaz = this.state.user === \"\" && this.state.users.map(u => /*#__PURE__*/React.createElement(PrikazKorisnika, {\n      handleClick: this.handleClick,\n      handleChange: this.handleChange,\n      key: u.korisnickoIme,\n      user: u,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 76\n      }\n    }));\n    const prikazKorisnika = this.state.user !== \"\" && /*#__PURE__*/React.createElement(Korisnik, {\n      handleChange: this.handleChange,\n      deleteUser: this.deleteUser,\n      state: this.state,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 57\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"Users\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      id: \"tableUsers\",\n      border: \"1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(FilterUsers, {\n      filter: this.filter,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 21\n      }\n    }, prikaz)), prikazKorisnika);\n  }\n\n}\n\nexport default Users;","map":{"version":3,"sources":["C:/Users/Dejan/Documents/resources/src/Users.jsx"],"names":["React","PrikazKorisnika","FilterUsers","Korisnik","$","Users","Component","constructor","state","users","user","admin","handleChange","bind","filter","handleClick","deleteUser","componentDidMount","config","headers","Headers","localStorage","getItem","fetch","then","res","json","setState","event","checked","target","prevState","updateUsers","map","u","korisnickoIme","authorities","dataType","method","body","JSON","stringify","console","log","username","val","role","sort","name","a","includes","hide","show","children","remove","render","prikaz","prikazKorisnika"],"mappings":"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","sourcesContent":["import React from \"react\"\r\n\r\nimport PrikazKorisnika from \"./PrikazSvihKorisnika\"\r\nimport FilterUsers from \"./FilterUsers\"\r\nimport Korisnik from \"./Korisnik\"\r\n\r\nimport $ from \"jquery\"\r\n\r\nclass Users extends React.Component{\r\n\r\n    constructor(){\r\n        super()\r\n        this.state = {\r\n            users: [],\r\n            user: \"\",\r\n            admin: false\r\n        }\r\n        this.handleChange=this.handleChange.bind(this)\r\n        this.filter=this.filter.bind(this);\r\n        this.handleClick=this.handleClick.bind(this);\r\n        this.deleteUser=this.deleteUser.bind(this);\r\n    }\r\n\r\n    componentDidMount(){\r\n        const config={\r\n            headers: new Headers({'Authorization': 'Bearer ' + localStorage.getItem('jwt')},\r\n                                  {'Access-Control-Allow-Methods':'GET'}),\r\n          };\r\n\r\n        fetch('http://localhost:8080/bioskop/users',config)\r\n            .then(res => res.json())\r\n            .then(res => {\r\n                this.setState({\r\n                    users: res\r\n                })\r\n            })\r\n    }\r\n\r\n    handleChange(event){\r\n        const checked = event.target.checked\r\n        if(checked === true){\r\n            this.setState(prevState => {\r\n                const updateUsers=prevState.users.map(u => {\r\n                    if(u.korisnickoIme === prevState.user.korisnickoIme){\r\n                        u.authorities=\"ROLE_REGULAR ROLE_ADMIN\"\r\n                        var config={\r\n                            dataType: 'json',\r\n                            method: 'put',\r\n                            headers: {'Authorization': 'Bearer ' + localStorage.getItem('jwt')},\r\n                            body: JSON.stringify(u)\r\n                          };\r\n                \r\n                        // On submit of the form, send a POST request with the data to the server.\r\n                        fetch('http://localhost:8080/bioskop/users',config)\r\n                            .then(res => res.json())\r\n                            .then(res => console.log(res))\r\n                    }\r\n                    return u;\r\n                })\r\n                return {\r\n                    users: updateUsers,\r\n                    admin: true\r\n                }\r\n            })\r\n        }else{\r\n            this.setState(prevState => {\r\n                const updateUsers=prevState.users.map(u => {\r\n                    if(u.korisnickoIme === prevState.user.korisnickoIme){\r\n                        u.authorities=\"ROLE_REGULAR \"\r\n                        var config={\r\n                            dataType: 'json',\r\n                            method: 'put',\r\n                            headers: {'Authorization': 'Bearer ' + localStorage.getItem('jwt')},\r\n                            body: JSON.stringify(u)\r\n                          };\r\n                \r\n                        // On submit of the form, send a POST request with the data to the server.\r\n                        fetch('http://localhost:8080/bioskop/users',config)\r\n                            .then(res => res.json())\r\n                            .then(res => console.log(res))\r\n                    }\r\n                    return u;\r\n                })\r\n                return {\r\n                    users: updateUsers,\r\n                    admin: false\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    filter(){\r\n        const username=$('#idUsername').val() === \"\" ? \"null\":$('#idUsername').val();\r\n        const role=$('#idRole').val() === \"\" ? \"null\":$('#idRole').val();\r\n        const sort=$('#idSort').val() === \"\" ? \"null\":$('#idSort').val();\r\n\r\n        fetch('http://localhost:8080/bioskop/users/'+username+\"/\"+role+\"/\"+sort)\r\n            .then(res => res.json())\r\n            .then(res => {\r\n                this.setState({\r\n                    users: res\r\n                })\r\n            })\r\n    }\r\n\r\n    handleClick(event){\r\n        const name=event.target.name\r\n        this.state.users.map(u => {\r\n            if(u.korisnickoIme === name){\r\n                const a=u.authorities.includes(\"ROLE_ADMIN\") ? true:false\r\n                this.setState({\r\n                    user:u,\r\n                    admin:a\r\n                })\r\n            }\r\n        })\r\n        $('#tableUsers').hide();\r\n    }\r\n\r\n    deleteUser(event){\r\n        const name = event.target.name\r\n        var config={\r\n            method: 'delete',\r\n            headers: {'Authorization': 'Bearer ' + localStorage.getItem('jwt')}\r\n          };\r\n\r\n        // On submit of the form, send a POST request with the data to the server.\r\n        fetch('http://localhost:8080/bioskop/users/'+name,config)\r\n\r\n        this.setState({\r\n            user: \"\"\r\n        })\r\n        \r\n        this.setState(prevState => {\r\n            const updateUsers=prevState.users.filter(u => u.korisnickoIme !== name)\r\n            return {\r\n                users: updateUsers\r\n            }\r\n        })\r\n        \r\n        $('#tableUsers').show()\r\n        $('#Bioskop').children('#idKorisnik').remove()\r\n    }\r\n\r\n    render(){\r\n        const prikaz = this.state.user === \"\" && this.state.users.map(u => <PrikazKorisnika handleClick={this.handleClick} handleChange={this.handleChange} key={u.korisnickoIme} user={u} />)\r\n        const prikazKorisnika=this.state.user !== \"\" && <Korisnik handleChange={this.handleChange} deleteUser={this.deleteUser} state={this.state} />\r\n        return(\r\n            <div id=\"Users\">\r\n                <table id=\"tableUsers\" border=\"1\">\r\n                    <FilterUsers filter={this.filter} />\r\n                    <tbody>\r\n                    {prikaz}\r\n                    </tbody>\r\n                </table>\r\n                {prikazKorisnika}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Users"]},"metadata":{},"sourceType":"module"}