{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dejan\\\\Documents\\\\resources\\\\src\\\\Users.jsx\";\nimport React from \"react\";\nimport PrikazKarata from \"./PrikazKarata\";\nimport PrikazKorisnika from \"./PrikazSvihKorisnika\";\nimport FilterUsers from \"./FilterUsers\";\nimport Korisnik from \"./Korisnik\";\nimport $ from \"jquery\";\n\nclass Users extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      users: [],\n      user: \"\",\n      admin: false\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.filter = this.filter.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.deleteUser = this.deleteUser.bind(this);\n    this.cancel = this.cancel.bind(this);\n  }\n\n  componentDidMount() {\n    const config = {\n      headers: new Headers({\n        'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n      }, {\n        'Access-Control-Allow-Methods': 'GET'\n      })\n    };\n    fetch('http://localhost:8080/bioskop/users', config).then(res => res.json()).then(res => {\n      this.setState({\n        users: res\n      });\n    });\n  }\n\n  cancel() {\n    this.setState({\n      user: \"\"\n    });\n    $('#idKorisnik').hide();\n    $('#prikazKarata').hide();\n    $('#tableUsers').show();\n  }\n\n  handleChange(event) {\n    const checked = event.target.checked;\n\n    if (checked === true) {\n      this.setState(prevState => {\n        const updateUsers = prevState.users.map(u => {\n          if (u.korisnickoIme === prevState.user.korisnickoIme) {\n            u.authorities = \"ROLE_USER ROLE_ADMIN\";\n            var config = {\n              dataType: 'json',\n              method: 'put',\n              headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n              },\n              body: JSON.stringify(u)\n            }; // On submit of the form, send a POST request with the data to the server.\n\n            fetch('http://localhost:8080/bioskop/users', config).then(res => res.json()).then(res => console.log(res));\n          }\n\n          return u;\n        });\n        return {\n          users: updateUsers,\n          admin: true\n        };\n      });\n    } else {\n      this.setState(prevState => {\n        const updateUsers = prevState.users.map(u => {\n          if (u.korisnickoIme === prevState.user.korisnickoIme) {\n            u.authorities = \"ROLE_USER \";\n            var config = {\n              dataType: 'json',\n              method: 'put',\n              headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n              },\n              body: JSON.stringify(u)\n            }; // On submit of the form, send a POST request with the data to the server.\n\n            fetch('http://localhost:8080/bioskop/users', config).then(res => res.json()).then(res => console.log(res));\n          }\n\n          return u;\n        });\n        return {\n          users: updateUsers,\n          admin: false\n        };\n      });\n    }\n  }\n\n  filter() {\n    var config = {\n      method: 'get',\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n      }\n    };\n    const username = $('#idUsername').val() === \"\" ? \"null\" : $('#idUsername').val();\n    const role = $('#idRole').val() === \"\" ? \"null\" : $('#idRole').val();\n    const sort = $('#idSort').val() === \"\" ? \"null\" : $('#idSort').val();\n    fetch('http://localhost:8080/bioskop/users/' + username + \"/\" + role + \"/\" + sort, config).then(res => res.json()).then(res => {\n      this.setState({\n        users: res\n      });\n    });\n  }\n\n  handleClick(event) {\n    const name = event.target.name;\n    this.state.users.map(u => {\n      if (u.korisnickoIme === name) {\n        const a = u.authorities.includes(\"ROLE_ADMIN\") ? true : false;\n        this.setState({\n          user: u,\n          admin: a\n        });\n      }\n    });\n    $('#tableUsers').hide();\n  }\n\n  deleteUser(event) {\n    const name = event.target.name;\n    var config = {\n      method: 'delete',\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n      }\n    }; // On submit of the form, send a POST request with the data to the server.\n\n    fetch('http://localhost:8080/bioskop/users/' + name, config);\n    this.setState({\n      user: \"\"\n    });\n    this.setState(prevState => {\n      const updateUsers = prevState.users.filter(u => u.korisnickoIme !== name);\n      return {\n        users: updateUsers\n      };\n    });\n    $('#tableUsers').show();\n    $('#Bioskop').children('#idKorisnik').remove();\n  }\n\n  render() {\n    const prikaz = this.state.user === \"\" && this.state.users.map(u => /*#__PURE__*/React.createElement(PrikazKorisnika, {\n      handleClick: this.handleClick,\n      handleChange: this.handleChange,\n      key: u.korisnickoIme,\n      user: u,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 76\n      }\n    }));\n    const prikazKorisnika = this.state.user !== \"\" && /*#__PURE__*/React.createElement(Korisnik, {\n      cancel: this.cancel,\n      handleChange: this.handleChange,\n      deleteUser: this.deleteUser,\n      state: this.state,\n      users: this.props.users,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 57\n      }\n    });\n    const prikazKarata = this.state.user !== \"\" && /*#__PURE__*/React.createElement(PrikazKarata, {\n      cancel: this.cancel,\n      state: this.state,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 54\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"Users\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"tableUsers\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 21\n      }\n    }, \"Sortiraj po:\", /*#__PURE__*/React.createElement(\"select\", {\n      id: \"idSort\",\n      onChange: this.filter,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 33\n      }\n    }), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"ki-asc\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 33\n      }\n    }, \"Korisnickom imenu, rastuce\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"ki-desc\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 33\n      }\n    }, \"Korisnickom imenu, opadajuce\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"u-asc\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 33\n      }\n    }, \"Ulozi, rastuce\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"u-desc\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 33\n      }\n    }, \"Ulozi, opadajuce\"))), /*#__PURE__*/React.createElement(\"table\", {\n      border: \"1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(FilterUsers, {\n      filter: this.filter,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 25\n      }\n    }, prikaz))), prikazKorisnika, prikazKarata);\n  }\n\n}\n\nexport default Users;","map":{"version":3,"sources":["C:/Users/Dejan/Documents/resources/src/Users.jsx"],"names":["React","PrikazKarata","PrikazKorisnika","FilterUsers","Korisnik","$","Users","Component","constructor","state","users","user","admin","handleChange","bind","filter","handleClick","deleteUser","cancel","componentDidMount","config","headers","Headers","localStorage","getItem","fetch","then","res","json","setState","hide","show","event","checked","target","prevState","updateUsers","map","u","korisnickoIme","authorities","dataType","method","body","JSON","stringify","console","log","username","val","role","sort","name","a","includes","children","remove","render","prikaz","prikazKorisnika","props","prikazKarata"],"mappings":"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","sourcesContent":["import React from \"react\"\r\n\r\nimport PrikazKarata from \"./PrikazKarata\"\r\nimport PrikazKorisnika from \"./PrikazSvihKorisnika\"\r\nimport FilterUsers from \"./FilterUsers\"\r\nimport Korisnik from \"./Korisnik\"\r\n\r\nimport $ from \"jquery\"\r\n\r\nclass Users extends React.Component{\r\n\r\n    constructor(){\r\n        super()\r\n        this.state = {\r\n            users: [],\r\n            user: \"\",\r\n            admin: false\r\n        }\r\n        this.handleChange=this.handleChange.bind(this)\r\n        this.filter=this.filter.bind(this);\r\n        this.handleClick=this.handleClick.bind(this);\r\n        this.deleteUser=this.deleteUser.bind(this);\r\n        this.cancel=this.cancel.bind(this)\r\n    }\r\n\r\n    componentDidMount(){\r\n    \r\n        const config={\r\n            headers: new Headers({'Authorization': 'Bearer ' + localStorage.getItem('jwt')},\r\n                                  {'Access-Control-Allow-Methods':'GET'}),\r\n          };\r\n\r\n        fetch('http://localhost:8080/bioskop/users',config)\r\n            .then(res => res.json())\r\n            .then(res => {\r\n                this.setState({\r\n                    users: res\r\n                })\r\n            })\r\n    }\r\n\r\n    cancel(){\r\n        this.setState({user:\"\"})\r\n        $('#idKorisnik').hide()\r\n        $('#prikazKarata').hide()\r\n        $('#tableUsers').show()\r\n    }\r\n\r\n    handleChange(event){\r\n        const checked = event.target.checked\r\n        if(checked === true){\r\n            this.setState(prevState => {\r\n                const updateUsers=prevState.users.map(u => {\r\n                    if(u.korisnickoIme === prevState.user.korisnickoIme){\r\n                        u.authorities=\"ROLE_USER ROLE_ADMIN\"\r\n                        var config={\r\n                            dataType: 'json',\r\n                            method: 'put',\r\n                            headers: {'Authorization': 'Bearer ' + localStorage.getItem('jwt')},\r\n                            body: JSON.stringify(u)\r\n                          };\r\n                \r\n                        // On submit of the form, send a POST request with the data to the server.\r\n                        fetch('http://localhost:8080/bioskop/users',config)\r\n                            .then(res => res.json())\r\n                            .then(res => console.log(res))\r\n                    }\r\n                    return u;\r\n                })\r\n                return {\r\n                    users: updateUsers,\r\n                    admin: true\r\n                }\r\n            })\r\n        }else{\r\n            this.setState(prevState => {\r\n                const updateUsers=prevState.users.map(u => {\r\n                    if(u.korisnickoIme === prevState.user.korisnickoIme){\r\n                        u.authorities=\"ROLE_USER \"\r\n                        var config={\r\n                            dataType: 'json',\r\n                            method: 'put',\r\n                            headers: {'Authorization': 'Bearer ' + localStorage.getItem('jwt')},\r\n                            body: JSON.stringify(u)\r\n                          };\r\n                \r\n                        // On submit of the form, send a POST request with the data to the server.\r\n                        fetch('http://localhost:8080/bioskop/users',config)\r\n                            .then(res => res.json())\r\n                            .then(res => console.log(res))\r\n                    }\r\n                    return u;\r\n                })\r\n                return {\r\n                    users: updateUsers,\r\n                    admin: false\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    filter(){\r\n        var config={\r\n            method: 'get',\r\n            headers: {'Authorization': 'Bearer ' + localStorage.getItem('jwt')}\r\n          };\r\n\r\n        const username=$('#idUsername').val() === \"\" ? \"null\":$('#idUsername').val();\r\n        const role=$('#idRole').val() === \"\" ? \"null\":$('#idRole').val();\r\n        const sort=$('#idSort').val() === \"\" ? \"null\":$('#idSort').val();\r\n\r\n        fetch('http://localhost:8080/bioskop/users/'+username+\"/\"+role+\"/\"+sort,config)\r\n            .then(res => res.json())\r\n            .then(res => {\r\n                this.setState({\r\n                    users: res\r\n                })\r\n            })\r\n    }\r\n\r\n    handleClick(event){\r\n        const name=event.target.name\r\n        this.state.users.map(u => {\r\n            if(u.korisnickoIme === name){\r\n                const a=u.authorities.includes(\"ROLE_ADMIN\") ? true:false\r\n                this.setState({\r\n                    user:u,\r\n                    admin:a\r\n                })\r\n            }\r\n        })\r\n        $('#tableUsers').hide();\r\n    }\r\n\r\n    deleteUser(event){\r\n        const name = event.target.name\r\n        var config={\r\n            method: 'delete',\r\n            headers: {'Authorization': 'Bearer ' + localStorage.getItem('jwt')}\r\n          };\r\n\r\n        // On submit of the form, send a POST request with the data to the server.\r\n        fetch('http://localhost:8080/bioskop/users/'+name,config)\r\n\r\n        this.setState({\r\n            user: \"\"\r\n        })\r\n        \r\n        this.setState(prevState => {\r\n            const updateUsers=prevState.users.filter(u => u.korisnickoIme !== name)\r\n            return {\r\n                users: updateUsers\r\n            }\r\n        })\r\n        \r\n        $('#tableUsers').show()\r\n        $('#Bioskop').children('#idKorisnik').remove()\r\n    }\r\n\r\n    render(){\r\n        const prikaz = this.state.user === \"\" && this.state.users.map(u => <PrikazKorisnika handleClick={this.handleClick} handleChange={this.handleChange} key={u.korisnickoIme} user={u} />)\r\n        const prikazKorisnika=this.state.user !== \"\" && <Korisnik cancel={this.cancel} handleChange={this.handleChange} deleteUser={this.deleteUser} state={this.state} users={this.props.users}/>\r\n        const prikazKarata=this.state.user !== \"\" && <PrikazKarata cancel={this.cancel} state={this.state}/>\r\n        \r\n        return(\r\n            <div id=\"Users\">\r\n                <div id=\"tableUsers\">\r\n                    <label>\r\n                        Sortiraj po:\r\n                            <select id=\"idSort\" onChange={this.filter}>\r\n                                <option value=\"\"></option>\r\n                                <option value=\"ki-asc\">Korisnickom imenu, rastuce</option>\r\n                                <option value=\"ki-desc\">Korisnickom imenu, opadajuce</option>\r\n                                <option value=\"u-asc\">Ulozi, rastuce</option>\r\n                                <option value=\"u-desc\">Ulozi, opadajuce</option>\r\n                            </select>\r\n                    </label>\r\n                    <table border=\"1\">\r\n                        <FilterUsers filter={this.filter} />\r\n                        <tbody>\r\n                            {prikaz}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n                {prikazKorisnika}\r\n                {prikazKarata}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Users"]},"metadata":{},"sourceType":"module"}